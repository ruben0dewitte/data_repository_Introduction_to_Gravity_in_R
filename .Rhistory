x = rrightparetolognormal(1e5,shape2=1.5,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=101,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# RNGs --------------------------------------------------------------------
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
pl(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.8,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=101,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
pl(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.8,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
pl(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.8,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
pl(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.8,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.8,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.8,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.8,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
pop_average
sample_average
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.5,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.5,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(x))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.5,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
pop_average
sample_average
x = rrightparetolognormal(1e4,shape2=1.5,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
pop_average
sample_average
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.5,meanlog=-0.5,sdlog=0.5)
lines(density(x),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.8,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
pop_average
sample_average
pop_average = mrightparetolognormal(r=1,shape2=1.5,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
pop_average
sample_average
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.5,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
sample_average
pop_average
pop_average = mrightparetolognormal(r=1,shape2=1.3,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
pop_average
sample_average = mean(x)
sample_average
?rcomposite
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 1.5, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff))
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 1.5, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff)
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
sample_average
pop_average
pop_average = mcomposite(r=1,dist = dist, coeff = coeff)
pop_average
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 1.5, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff)
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
sample_average
pop_average
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
sample_average
pop_average
x = rcomposite(1e4, dist = dist, coeff = coeff)
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
pop_average
sample_average
x = rcomposite(1e4, dist = dist, coeff = coeff)
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
pop_average
sample_average
x = rcomposite(1e4, dist = dist, coeff = coeff)
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
library(distributionsrd)
library(flexmix)
# RNGs --------------------------------------------------------------------
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(log(x)))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(log(x)),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.1,meanlog=-0.5,sdlog=0.5)
lines(density(log(x)),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.1,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
sample_average
pop_average
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 10, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff)
lines(density(log(x)),col="purple")
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 1.1, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff)
lines(density(log(x)),col="blue")
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
pop_average
sample_average
source("C:/Users/rldwitte/OneDrive - UGent/Courses/MastherTheses/2021-2022/TimothyDeCampenaere/start.R", echo=TRUE)
x = rpareto(1e4, k=1.1,xmin=0.1)
lines(density(log(x)),col="orange")
x = rpareto(1e4, k=1.1,xmin=0.1)
lines(density(log(x)),col="orange")
## Averages
sample_average = mean(x)
pop_average = mpareto(r=1,k=1.1,xmin=0.1,lower.tail=FALSE)
sample_average
pop_average
?rcombdist
data("fit_US_cities")
subset(fit_US_cities, (dist == "lnorm" & components == 5))$prior[[1]]
subset(fit_US_cities, (dist == "lnorm" & components == 5))$coefficients[[1]]
class(subset(fit_US_cities, (dist == "lnorm" & components == 5))$coefficients[[1]])
matrix(c(-0.5,0.5,0.5,1),nrow = 2, ncol = 2)
x = rcombdist(1e4,dist="lnorm",
prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,0.5,1),nrow = 2, ncol = 2))
plot(density(x))
plot(density(log(x)))
x = rcombdist(1e4,dist="lnorm",
prior=c(0.7,0.3),
coeff = matrix(c(-0.5,2,0.5,1),nrow = 2, ncol = 2))
plot(density(log(x)))
dist = "lnorm"
components = 2
x = rcombdist(1e4,dist="lnorm",
prior=c(0.7,0.3),
coeff = matrix(c(-0.5,2,0.5,2),nrow = 2, ncol = 2))
plot(density(log(x)))
dist = "lnorm"
components = 2
x = rcombdist(1e4,dist="lnorm",
prior=c(0.7,0.3),
coeff = matrix(c(-1,2,0.5,2),nrow = 2, ncol = 2))
plot(density(log(x)))
coeff
matrix(c(-1,2,0.5,2),nrow = 2, ncol = 2)
dist = "lnorm"
components = 2
x = rcombdist(1e4,dist="lnorm",
prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,0.5,1),nrow = 2, ncol = 2))
plot(density(log(x)))
dist = "lnorm"
components = 2
x = rcombdist(1e4,dist="lnorm",
prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2))
plot(density(log(x)))
fit = combdist.mle(x=x,components=2,dist="lnorm",steps=20,nested=T)
fit
pop_average_true = mcombdist(r=1,dist="lnorm"), prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2))
pop_average_true = mcombdist(r=1,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2))
mcombdist(r=1,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2))
?mcombdist
matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2)
mcombdist(r=1,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2),lower.tail=TRUE)
mcombdist(r=1,dist="lnorm", prior=fit$prior,
coeff = fit$coeff,lower.tail=TRUE)
mcombdist(r=1,truncation=0,dist="lnorm", prior=fit$prior,
coeff = fit$coeff,lower.tail=TRUE)
mcombdist(r=1,truncation=0,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2),lower.tail=TRUE)
mcombdist(r=1,truncation=0,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2),lower.tail=TRUE,nested=TRUE)
mcombdist(r=1,truncation=0,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2),lower.tail=FALSE)
mcombdist(r=1,truncation=0,dist="lnorm", prior=fit$prior,
coeff = fit$coeff,lower.tail=FALSE)
fit$prior
mcombdist(r=1,truncation=0,dist="lnorm", prior=fit$prior[[1]],
coeff = fit$coeff[[1]],lower.tail=FALSE)
pop_average_true = mcombdist(r=1,truncation=0,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2),lower.tail=FALSE)
pop_average_true
pop_average_fitted = mcombdist(r=1,truncation=0,dist="lnorm", prior=fit$prior[[1]],
coeff = fit$coeff[[1]],lower.tail=FALSE)
pop_average_fitted
sample_average = mean(x)
sample_average
library(distributionsrd)
# RNGs --------------------------------------------------------------------
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(log(x)))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(log(x)),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.1,meanlog=-0.5,sdlog=0.5)
lines(density(log(x)),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.1,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Lognormal-Pareto distribution with light tail
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 10, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff)
lines(density(log(x)),col="purple")
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
# Lognormal-Pareto distribution with heavy tail
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 1.1, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff)
lines(density(log(x)),col="blue")
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
# Lognormal-Pareto distribution with heavy tail
x = rpareto(1e4, k=1.1,xmin=0.1)
lines(density(log(x)),col="orange")
## Averages
sample_average = mean(x)
pop_average = mpareto(r=1,k=1.1,xmin=0.1,lower.tail=FALSE)
# Fitting -----------------------------------------------------------------
## Finite mixture model
dist = "lnorm"
components = 2
x = rcombdist(1e4,dist="lnorm",
prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2))
plot(density(log(x)))
fit = combdist.mle(x=x,components=2,dist="lnorm",steps=20,nested=T)
fit$prior
fit$coefficients
## Averages
sample_average = mean(x)
pop_average_fitted = mcombdist(r=1,truncation=0,dist="lnorm", prior=fit$prior[[1]],
coeff = fit$coeff[[1]],lower.tail=FALSE)
pop_average_true = mcombdist(r=1,truncation=0,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2),lower.tail=FALSE)
pop_average_true
pop_average_fitted
sample_average
library(distributionsrd)
# RNGs --------------------------------------------------------------------
set.seed(1234)
# Log-normal
x = rlnorm(1e4,mean=-0.5,sd=0.5)
plot(density(log(x)))
## Averages
sample_average = mean(x)
pop_average = mlnorm(r=1,mean=-0.5,sd=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with light tail
x = rrightparetolognormal(1e4,shape2=10,meanlog=-0.5,sdlog=0.5)
lines(density(log(x)),col="green")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=10,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Right-Pareto Lognormal with heavy tail
x = rrightparetolognormal(1e4,shape2=1.1,meanlog=-0.5,sdlog=0.5)
lines(density(log(x)),col="red")
## Averages
sample_average = mean(x)
pop_average = mrightparetolognormal(r=1,shape2=1.1,meanlog=-0.5,sdlog=0.5,lower.tail=FALSE)
# Lognormal-Pareto distribution with light tail
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 10, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff)
lines(density(log(x)),col="purple")
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
# Lognormal-Pareto distribution with heavy tail
dist <- c("lnorm", "pareto")
coeff <- c(coeff2.k = 1.1, coeff1.meanlog = -0.5, coeff1.sdlog = 0.5)
x = rcomposite(1e4, dist = dist, coeff = coeff)
lines(density(log(x)),col="blue")
## Averages
sample_average = mean(x)
pop_average = mcomposite(r=1,dist = dist, coeff = coeff,lower.tail=FALSE)
# Lognormal-Pareto distribution with heavy tail
x = rpareto(1e4, k=1.1,xmin=0.1)
lines(density(log(x)),col="orange")
## Averages
sample_average = mean(x)
pop_average = mpareto(r=1,k=1.1,xmin=0.1,lower.tail=FALSE)
# Fitting -----------------------------------------------------------------
## Finite mixture model
dist = "lnorm"
components = 2
x = rcombdist(1e4,dist="lnorm",
prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2))
plot(density(log(x)))
fit = combdist.mle(x=x,components=2,dist="lnorm",steps=20,nested=T) # MLE estimation (relies on packge flexmix underneath)
fit$prior
fit$coefficients
## Averages
sample_average = mean(x)
pop_average_fitted = mcombdist(r=1,truncation=0,dist="lnorm", prior=fit$prior[[1]],
coeff = fit$coeff[[1]],lower.tail=FALSE)
pop_average_true = mcombdist(r=1,truncation=0,dist="lnorm", prior=c(0.7,0.3),
coeff = matrix(c(-0.5,0.5,2,1),nrow = 2, ncol = 2),lower.tail=FALSE)
pop_average_true
sample_average
pop_average_fitted
renv::upgrade()
renv::snapshot()
